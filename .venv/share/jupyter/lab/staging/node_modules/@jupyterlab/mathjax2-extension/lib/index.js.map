{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../mathjax2-extension/src/index.ts"],"names":[],"mappings":"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","sourcesContent":["/*-----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|----------------------------------------------------------------------------*/\n\nimport { JupyterLabPlugin } from '@jupyterlab/application';\n\nimport { PageConfig } from '@jupyterlab/coreutils';\n\nimport { ILatexTypesetter } from '@jupyterlab/rendermime';\n\nimport { IRenderMime } from '@jupyterlab/rendermime-interfaces';\n\nimport { PromiseDelegate } from '@phosphor/coreutils';\n\n// Stub for window MathJax.\ndeclare var MathJax: any;\n\n/**\n * The MathJax latexTypesetter plugin.\n */\nconst plugin: JupyterLabPlugin<ILatexTypesetter> = {\n  id: '@jupyterlab/mathjax2-extension:plugin',\n  autoStart: true,\n  provides: ILatexTypesetter,\n  activate: () => new MathJaxTypesetter()\n};\n\n/**\n * Export the plugin as default.\n */\nexport default plugin;\n\n/**\n * The MathJax Typesetter.\n */\nexport class MathJaxTypesetter implements IRenderMime.ILatexTypesetter {\n  /**\n   * Typeset the math in a node.\n   *\n   * #### Notes\n   * MathJax schedules the typesetting asynchronously,\n   * but there are not currently any callbacks or Promises\n   * firing when it is done.\n   */\n  typeset(node: HTMLElement): void {\n    if (!this._initialized) {\n      this._init();\n    }\n    this._initPromise.promise.then(() => {\n      MathJax.Hub.Queue(['Typeset', MathJax.Hub, node]);\n      try {\n        MathJax.Hub.Queue(\n          ['Require', MathJax.Ajax, '[MathJax]/extensions/TeX/AMSmath.js'],\n          () => {\n            MathJax.InputJax.TeX.resetEquationNumbers();\n          }\n        );\n      } catch (e) {\n        console.error('Error queueing resetEquationNumbers:', e);\n      }\n    });\n  }\n\n  /**\n   * Initialize MathJax.\n   */\n  private _init(): void {\n    let url = PageConfig.getOption('mathjaxUrl');\n    let config = PageConfig.getOption('mathjaxConfig');\n    let head = document.getElementsByTagName('head')[0];\n    let script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = `${url}?config=${config}&amp;delayStartupUntil=configured\" charset=\"utf-8\"`;\n    head.appendChild(script);\n    script.addEventListener('load', () => {\n      this._onLoad();\n    });\n    this._initialized = true;\n  }\n\n  /**\n   * Handle MathJax loading.\n   */\n  private _onLoad(): void {\n    MathJax.Hub.Config({\n      tex2jax: {\n        inlineMath: [['$', '$'], ['\\\\(', '\\\\)']],\n        displayMath: [['$$', '$$'], ['\\\\[', '\\\\]']],\n        processEscapes: true,\n        processEnvironments: true\n      },\n      // Center justify equations in code and markdown cells. Elsewhere\n      // we use CSS to left justify single line equations in code cells.\n      displayAlign: 'center',\n      CommonHTML: {\n        linebreaks: { automatic: true }\n      },\n      'HTML-CSS': {\n        availableFonts: [],\n        imageFont: null,\n        preferredFont: null,\n        webFont: 'STIX-Web',\n        styles: { '.MathJax_Display': { margin: 0 } },\n        linebreaks: { automatic: true }\n      },\n      skipStartupTypeset: true\n    });\n    MathJax.Hub.Configured();\n    this._initPromise.resolve(void 0);\n  }\n\n  private _initPromise = new PromiseDelegate<void>();\n  private _initialized = false;\n}\n"]}