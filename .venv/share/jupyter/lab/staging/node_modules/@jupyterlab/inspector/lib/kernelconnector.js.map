{"version":3,"file":"kernelconnector.js","sourceRoot":"","sources":["../../../../inspector/src/kernelconnector.ts"],"names":[],"mappings":";AAAA,0CAA0C;AAC1C,2DAA2D;;AAI3D,qDAAsD;AAMtD;;GAEG;AACH,qBAA6B,SAAQ,yBAIpC;IACC;;;;OAIG;IACH,YAAY,OAAiC;QAC3C,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC;IAClC,CAAC;IAED;;;;OAIG;IACH,KAAK,CACH,OAAmC;QAEnC,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;QAEpC,IAAI,CAAC,MAAM,EAAE;YACX,OAAO,OAAO,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,qCAAqC,CAAC,CAAC,CAAC;SACzE;QAED,MAAM,QAAQ,GAAkC;YAC9C,IAAI,EAAE,OAAO,CAAC,IAAI;YAClB,UAAU,EAAE,OAAO,CAAC,MAAM;YAC1B,YAAY,EAAE,CAAC;SAChB,CAAC;QAEF,OAAO,MAAM,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;YAChD,MAAM,QAAQ,GAAG,GAAG,CAAC,OAAO,CAAC;YAE7B,IAAI,QAAQ,CAAC,MAAM,KAAK,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE;gBAC/C,MAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;aACpE;YAED,OAAO,EAAE,IAAI,EAAE,QAAQ,CAAC,IAAI,EAAE,QAAQ,EAAE,QAAQ,CAAC,QAAQ,EAAE,CAAC;QAC9D,CAAC,CAAC,CAAC;IACL,CAAC;CAGF;AA/CD,0CA+CC","sourcesContent":["// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\nimport { IClientSession } from '@jupyterlab/apputils';\n\nimport { DataConnector } from '@jupyterlab/coreutils';\n\nimport { KernelMessage } from '@jupyterlab/services';\n\nimport { InspectionHandler } from './handler';\n\n/**\n * The default connector for making inspection requests from the Jupyter API.\n */\nexport class KernelConnector extends DataConnector<\n  InspectionHandler.IReply,\n  void,\n  InspectionHandler.IRequest\n> {\n  /**\n   * Create a new kernel connector for inspection requests.\n   *\n   * @param options - The instatiation options for the kernel connector.\n   */\n  constructor(options: KernelConnector.IOptions) {\n    super();\n    this._session = options.session;\n  }\n\n  /**\n   * Fetch inspection requests.\n   *\n   * @param request - The inspection request text and details.\n   */\n  fetch(\n    request: InspectionHandler.IRequest\n  ): Promise<InspectionHandler.IReply> {\n    const kernel = this._session.kernel;\n\n    if (!kernel) {\n      return Promise.reject(new Error('Inspection fetch requires a kernel.'));\n    }\n\n    const contents: KernelMessage.IInspectRequest = {\n      code: request.text,\n      cursor_pos: request.offset,\n      detail_level: 0\n    };\n\n    return kernel.requestInspect(contents).then(msg => {\n      const response = msg.content;\n\n      if (response.status !== 'ok' || !response.found) {\n        throw new Error('Inspection fetch failed to return successfully.');\n      }\n\n      return { data: response.data, metadata: response.metadata };\n    });\n  }\n\n  private _session: IClientSession;\n}\n\n/**\n * A namespace for kernel connector statics.\n */\nexport namespace KernelConnector {\n  /**\n   * The instantiation options for an inspection handler.\n   */\n  export interface IOptions {\n    /**\n     * The session used to make API requests to the kernel.\n     */\n    session: IClientSession;\n  }\n}\n"]}